**Problme No:** 03392
**Problem Id:** 화성 지도


별거 없다고 생각하고 잡은 문제치고 꽤나 고전했다.


일단 sweeping + segment tree를 사용해서 풀 수 있는 문제인데, segment tree 부분이 일반적으로 널리 퍼져있는 lazy propagation 구현 형태로는 커버하기 어려운 부분이 있다.


sweeping 아이디어 먼저 설명하면, 일단 모든 직사각형을 직사각형을 이루는 두 개의 세로선 형태로 저장한다.


왼쪽 세로선을 opening edge, 오른쪽 세로선을 closing edge라고 불러보자.


x좌표를 1씩 늘려가며 sweeping하면서 opening edge가 등장하면 해당 사각형이 차지하는 y좌표 구간을 1씩 더해준다.


반대로, closing edge가 등장하면 해당 사각형이 차지하는 y좌표 구간을 1씩 빼준다.


결국 매 x좌표마다 전체 y구간(1~30000)에 대해 1 이상인 원소수를 세는 쿼리를 날려주면 가로 길이가 1인 단위 직사각형 넓이를 구할 수 있다.


sweeping 아이디어는 매우 간결한데, 문제는 segment tree이다.


이 문제에서 구간에 대한 업데이트는 더하기로 이뤄지는데 반해, 쿼리는 1 이상인 원소 수로 주어진다.


즉, segment tree의 각 노드 값을 합으로 저장해야 할지, 아니면 구간 내 1 이상의 원소 수로 저장해야할지 난처해진다.


여기서 사용하는 방법은 각 노드를 아래 2가지 값을 갖도록 표현하는 것이다.


- `length_[i]`: `i`를 루트로 하는 노드가 표현하는 구간 내에 1 이상의 원소의 수

- `change_[i]`: `i`를 루트로 하는 노드가 표현하는 구간에 가해졌던 변화의 총합
(단, 정확히 이 구간 전체에 가해진 경우만을 표현한다. 이 구간 중 일부에 가해진 경우는 표현하지 않음)


요렇게 정의해준 뒤에 `change_`를 업데이트하는 segment tree 로직을 구현하고 그 뒤에 이를 사용하는 `length_` 업데이트 로직을 추가해주면 된다.


자세한 부분은 코드를 보도록하자.

