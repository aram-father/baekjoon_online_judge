**Problme No:** 3640
**Problem Id:** 제독


정점을 분리하는 min-cost-max-flow 문제이다.


만약에, v에 도착하기 전에 같은 지점을 지나면 안된다는 조건이 없었다면(즉, 같은 간선만 안지나면 된다면), 풀이는 아래와 같이 매우 간단했을 것 이다.


1. 모든 간선에 용량 1을 준다.


2. 가상의 `source`를 만들고 `source`와 `정점 1`을 용량 2인 간선으로 연결한다.


3. 가상의 `sink`를 만들고 `정점 v`와 `sink`를 용량 2인 간선으로 연결한다.


4. mcmf를 푼다.


그런데, 위와 같은 풀이를 사용하면 같은 지점을 지나면 안된다는 조건을 만족할 수 없게 된다.


한 정점을 기준으로 아래와 같이 두 최단 경로가 교차하는 경우를 떠올려보면 반례가 쉽게 떠오른다.


```text

# 용량 제한을 어기지 않았지만, 2개의 경로가 모두 x를 지나고 있다.

\     ^
\     |
\     |
\---> x --->
\     ^
\     |
\     |

```


이를 해결하기 위해서는 `정점 x`를 `정점 x`로 들어오는 정점 `정점 x_i`와 `정점 x`에서 나가는 정점 `정점 x_o`로 분리해준 뒤, (`정점 x_i`, `정점_o`)에 용량 1을 주면 된다.


위의 예제를 재활용해서 정점을 분리해준다면, 아래와 같을 것이다.


눈여겨 볼 점은 이제 추가된 (`정점 x_i`, `정점 x_o`)으로 인해 앞선 예제가 더 이상 용량 제한을 만족하지 못하게 되었다는 점이다.


```text

\               ^
\               |
\               |
\---> x_i ---> x_o --->
\      ^
\      |
\      |

```


마지막으로 한 가지 주의할 점으로는 입력에 antiparallel한 edge가 존재할 수 있다는 점인데, 이에 대해선 아래 2가지 해법이 있을 수 있다.
이 문제에서는 1번 방법을 사용하였다.


1. adjacent_list + reverse edge pointing


2. isomorphic한 graph가 되도록 antiparallel에 대해 정점 추가하기
